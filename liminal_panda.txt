
https://industrialcyber.co/threat-landscape/chinas-liminal-panda-hackers-target-global-telecom-networks-in-stealthy-cyber-espionage-campaign/
https://www.crowdstrike.com/en-us/blog/liminal-panda-telecom-sector-threats/
https://www.crowdstrike.com/en-us/blog/an-analysis-of-lightbasin-telecommunications-attacks/



Liminal Panda es un grupo de ciberespionaje avanzado (APT) que ha sido asociado principalmente con operaciones dirigidas contra objetivos en India y China, con un enfoque en sectores gubernamentales, militares y de infraestructura crítica. A continuación, se describen algunos de los métodos de ataque comúnmente utilizados por este grupo:

El ataque comienza con un socio de roaming que permite el acceso inicial a los servidores eDNS. Los eDNS son cruciales ya que resuelven las direcciones IP de nodos internos como HLR y GGSN. Una vez dentro, se establece la persistencia con una puerta trasera y un emulador SGSN para C&C. El movimiento lateral permite al atacante llegar a otros nodos como HLR/HSS. Finalmente, la exfiltración de datos se realiza a través de túneles GTP, llevando la información sensible fuera de la red hacia el atacante.

Los túneles DNS, SIGTRAN y GTP son técnicas utilizadas por atacantes, como Liminal Panda, para la exfiltración de datos al abusar de protocolos de red legítimos para mover información de manera encubierta.

A continuación, se explica cómo funcionan estos túneles para la exfiltración:

Túneles DNS (Sistema de Nombres de Dominio):

¿Cómo funciona? El DNS es un protocolo fundamental para traducir nombres de dominio legibles por humanos a direcciones IP. Los atacantes abusan de este protocolo incrustando pequeños fragmentos de datos maliciosos dentro de las consultas y respuestas DNS legítimas.
Para exfiltración: Los datos a exfiltrar se codifican (por ejemplo, en Base64) y se dividen en partes pequeñas. Cada parte se incrusta en una subsección de una consulta DNS (por ejemplo, como un subdominio). Cuando el sistema comprometido realiza una consulta DNS para este dominio malicioso, el servidor DNS controlado por el atacante recibe la consulta y reconstruye los datos exfiltrados.
Ventajas para el atacante: El tráfico DNS suele estar permitido a través de los firewalls y rara vez es inspeccionado a fondo, lo que lo convierte en un canal discreto para la comunicación y la exfiltración.
Túneles SIGTRAN (Transporte de Señalización):

¿Cómo funciona? SIGTRAN es un conjunto de protocolos de la suite IP que transportan la señalización de voz y datos de las redes SS7 (Sistema de Señalización No. 7) a través de redes IP. Es vital para las operaciones de telecomunicaciones, como el enrutamiento de llamadas y la gestión de SMS.
Para exfiltración: Los atacantes pueden explotar vulnerabilidades o abusar de la confianza entre operadores para inyectar y encapsular datos dentro de los mensajes SIGTRAN. Estos mensajes, que se espera que contengan información de señalización, pueden ser manipulados para llevar cargas útiles de datos exfiltrados.
Ventajas para el atacante: La complejidad y la naturaleza crítica de las redes SIGTRAN a menudo resultan en una menor supervisión de seguridad en comparación con el tráfico de datos general, lo que facilita el movimiento encubierto de datos.
Túneles GTP (GPRS Tunnelling Protocol):

¿Cómo funciona? GTP es el protocolo principal utilizado en las redes móviles (2G, 3G, 4G, 5G) para transportar datos de usuarios y señalización entre los diferentes nodos de la red central (como SGSN, GGSN, MME, SGW, PGW). Crea "túneles" lógicos para el tráfico de datos.
Para exfiltración: Los atacantes, una vez que han comprometido un nodo dentro de la red móvil (como un SGSN, que Liminal Panda utiliza emuladores para lograr la persistencia y C&C), pueden abusar de los túneles GTP existentes o establecer nuevos túneles GTP maliciosos. Dentro de estos túneles, pueden encapsular y exfiltrar datos sensibles de suscriptores (como IMSI y SMS).
Ventajas para el atacante: El tráfico GTP es fundamental para la operación de las redes móviles y es voluminoso. La inspección profunda de paquetes en los túneles GTP puede ser un desafío, lo que permite a los atacantes esconder datos exfiltrados dentro de un flujo de tráfico que se considera legítimo y necesario para la conectividad móvil.
En resumen, Liminal Panda abusa de estos protocolos al incrustar datos robados dentro de su tráfico normal y esperado, utilizando la confianza y la falta de inspección profunda de estos protocolos en entornos de telecomunicaciones para evadir la detección y exfiltrar información sensible.


1. Técnicas de Ingeniería Social y Phishing
Correos electrónicos maliciosos: Liminal Panda utiliza campañas de phishing bien elaboradas, a menudo disfrazadas como comunicaciones legítimas de entidades gubernamentales o empresas.

Documentos ofimáticos infectados: Archivos de Word, Excel o PDF con macros maliciosas que, al ser ejecutados, descargan y ejecutan malware.

Suplantación de identidad (spear phishing): Personalización de mensajes para engañar a objetivos específicos (ejecutivos, funcionarios).

2. Uso de Malware Personalizado
DeedRat (o DeedRAT): Un RAT (Remote Access Trojan) utilizado para el control remoto de sistemas comprometidos.

PlugX: Otro RAT común en operaciones APT, usado para robo de datos y espionaje.

Keyloggers y módulos de exfiltración: Para capturar credenciales y datos sensibles.

3. Explotación de Vulnerabilidades
Zero-days y vulnerabilidades conocidas: Liminal Panda ha explotado fallos en software como Microsoft Office, navegadores y aplicaciones de uso común.

Ejemplo: Uso de exploits en CVE-2017-11882 (vulnerabilidad en Microsoft Equation Editor) para ejecución de código remoto.

4. Técnicas de Evasión y Persistencia
Ofuscación de código: Uso de scripts cifrados (VBS, PowerShell) para evitar detección.

Living-off-the-land (LotL): Abuso de herramientas legítimas del sistema (como WMIC, PsExec, PowerShell) para moverse lateralmente.

Inyección de procesos: Ejecución de malware en procesos legítimos (ej. explorer.exe) para evadir antivirus.

5. Ataques a la Cadena de Suministro (Supply Chain)
Compromiso de actualizaciones de software: Envenenamiento de paquetes de instalación o actualizaciones de proveedores legítimos para distribuir malware.

Ejemplo: Infección a través de instaladores de software comúnmente usado por los objetivos.

6. Comunicaciones C2 (Command and Control)
Dominios falsos: Uso de dominios que imitan organizaciones reales para alojar servidores C2.

Protocolos cifrados: Comunicaciones mediante HTTPS o DNS tunneling para evitar bloqueos.

Servidores proxy: Uso de múltiples capas de redireccionamiento para ocultar la infraestructura real.

Objetivos Principales
Entidades gubernamentales y militares (especialmente en India y China).

Infraestructura crítica (energía, telecomunicaciones).

Organizaciones con información geoestratégica sensible.


==============================================================================================================================================


grupo Liminal Panda, centrándose en objetivos del sector de telecomunicaciones, especialmente en infraestructuras basadas en protocolos como eDNS, GTP (GPRS Tunneling Protocol), y SIGTRAN. A continuación, se resume y explica cada fase:

1. Reconocimiento (Reconnaissance)
Objetivo: Recopilar información sobre protocolos de telecomunicaciones (GTP, SIGTRAN, DNS) y la infraestructura de redes móviles.

Técnicas:

Análisis de redes de operadores y sus sistemas de roaming.

Identificación de servidores eDNS (Enhanced DNS) vulnerables.

2. Acceso Inicial (Initial Access)
Vectores de ataque:

Explotación de vulnerabilidades: Ataques a servidores eDNS con credenciales débiles o fallos de software.

Aprovechamiento de relaciones de roaming: Abuso de acuerdos de confianza entre operadores para infiltrarse.

3. Persistencia
Backdoor "PingPong":

Implanta un mecanismo de acceso remoto persistente.

SGSN emulator: Simula un nodo SGSN (Serving GPRS Support Node) para crear túneles GTP legítimos, permitiendo comunicaciones encubiertas con servidores C2 (Command & Control).

4. Movimiento Lateral (Lateral Movement)
Herramienta "CordScan":

Escanea redes internas para identificar sistemas críticos (ej. HLR, VLR, centros de datos).

Abuso de confianza intra-operatoria:

Usa credenciales robadas o protocolos mal configurados (como GTP) para moverse entre sistemas.

5. Exfiltración de Datos (Data Exfiltration)
Robo de información sensible:

Datos de suscriptores: IMSI (Identidad del Usuario), registros de SMS, datos de llamadas.

Técnicas de exfiltración:

Túneles GTP/DNS/SIGTRAN: Encubre el tráfico de datos como tráfico legítimo de red.

Abuso de confianza inter-operatoria: Aprovecha acuerdos de roaming para enviar datos a servidores controlados por atacantes.

Técnicas Clave Destacadas
Ataques a eDNS:

Los servidores eDNS (usados en redes móviles para enrutamiento) son explotados para ganar acceso inicial.

Emulación de SGSN:

Permite crear túneles GTP falsos para comunicaciones C2, evadiendo detección.

Abuso de protocolos de telecomunicaciones:

GTP, SIGTRAN, y DNS son manipulados para moverse lateralmente y exfiltrar datos.

Objetivos Principales
Operadores de telecomunicaciones: Especialmente en India y Asia.

Infraestructura crítica: HLR (Home Location Register), centros de datos de SMS, sistemas de roaming.

Mitigación Recomendada
Parchear servidores eDNS y sistemas críticos.

Monitorizar túneles GTP inusuales (ej. conexiones a IPs desconocidas).

Restringir acuerdos de roaming y confianza inter-operatoria.

Auditar logs de SIGTRAN/DNS para detectar exfiltración encubierta.

Conclusión
Liminal Panda demuestra un enfoque altamente especializado en telecomunicaciones, combinando exploits técnicos con abuso de relaciones de confianza. Su uso de herramientas como PingPong y CordScan, junto con la emulación de nodos SGSN, los distingue como un APT sofisticado en este sector.


TERMINOS y ABREVIATURAS



1. eDNS (Enhanced DNS)
Qué es: Una versión mejorada del DNS tradicional, utilizada en redes móviles para resolver nombres de dominio asociados a servicios de roaming y conectividad entre operadores.

Uso en ataques:

Liminal Panda explota servidores eDNS con credenciales débiles o vulnerabilidades para ganar acceso inicial.

Permite redirigir tráfico o suplantar nodos críticos (ej. HLR).

2. GTP (GPRS Tunneling Protocol)
Qué es: Protocolo usado en redes 2G/3G/4G para encapsular y transportar datos de usuarios (voz, SMS, internet) entre nodos de la red móvil (GGSN, SGSN).

Uso en ataques:

Emulación de SGSN: Los atacantes crean túneles GTP falsos para comunicaciones encubiertas (C2).

Exfiltración: Ocultar datos robados (ej. IMSI) dentro de tráfico GTP legítimo.

3. SIGTRAN (Signaling Transport Protocol)
Qué es: Conjunto de protocolos para transmitir señales de telecomunicaciones (SS7) sobre redes IP. Usado en redes modernas para autenticación y roaming.

Uso en ataques:

Interceptación de llamadas/SMS: Explotar fallos en SIGTRAN para redirigir o capturar tráfico.

Suplantación de nodos: Inyectar mensajes maliciosos en la red.

4. IMSI (International Mobile Subscriber Identity)
Qué es: Identificador único de un usuario en una red móvil (guardado en la SIM). Se usa para autenticación y facturación.

Uso en ataques:

Robo de identidad: Clonar SIMs o realizar ataques de interceptación (IMSI catchers).

Rastreo de objetivos: Identificar usuarios específicos (ej. funcionarios).

5. SGSN (Serving GPRS Support Node)
Qué es: Nodo crítico en redes 2G/3G que gestiona la movilidad de usuarios y el enrutamiento de datos.

Uso en ataques:

Emulación maliciosa: Liminal Panda simula un SGSN falso para crear túneles GTP y mantener persistencia.

Movimiento lateral: Moverse entre redes aprovechando la confianza entre SGSN y GGSN.

Relación con los Ataques de Liminal Panda
eDNS + GTP: Para acceso inicial y exfiltración.

SIGTRAN: Abuso de protocolos de señalización para robo de datos.

IMSI: Objetivo principal (datos sensibles).

SGSN emulado: Herramienta clave para persistencia y C2.


